import requests
import hashlib

EXPECTED_MESSAGE = 'SUNSHINE RHYTHM'

URL = 'https://crypto02.chal.ctf.westerns.tokyo'

r = requests.post(URL, json={'cmd': 'pubkey'})
r = r.json()

n = int(r['pubkey']['n'], 10)
k = int(r['pubkey']['k'], 10)


m = 7647621505426523107416876116179503771882358225602233882688080500019700416074079641481433709829408187069837328548192260242213288375752541771980455357725520773932150990241200106710194070936521249397968646028251975570300856774501827288072745234025035794496061930945682174098054405440546453789891131472968763963211701605509016308957961233593474796671835082111731734173903413989101376338153157881536000538617570527656809006766854781353000424633201559848473157638877908589222891590426378306548494548233753531300670238544815960843418612332546932989237593742552831285809303013106494916607063536993429613432733764529882168669
m %= n

with open('data.py', 'w') as f:
	print('n =', n, file=f)
	print('k =', k, file=f)
	print('m =', m, file=f)

input('waiting')

with open('output.txt') as f:
	x, y = map(int, f.read().split())

assert (x**2 + k*y**2)%n == m


r = requests.post(URL, json={'cmd': 'verify', 'x': str(x), 'y': str(y), 'msg': EXPECTED_MESSAGE})
print(r.text)
