Baby ROCA
=========

We're given a RSA key generated with the ROCA vulnerability.

We basically implement the ROCA paper to factorize the key: [https://crocs.fi.muni.cz/_media/public/papers/nemec_roca_ccs17_preprint.pdf](https://crocs.fi.muni.cz/_media/public/papers/nemec_roca_ccs17_preprint.pdf)

`try.sage`: Uses a bruteforce method to calculate the M' value referenced in the paper.
`roca.sage`: Implements the ROCA attack to factorize the key.

```
$ sage roca.sage
10661 23622

23600
23500
23400
23300
23200
23100
23000
22900
22800
22700
22600
22500
22400
22300
22200
22100
22000
[569506916446123723573655962064940867212018762002725]
29439910107053949247271976001319065960445588604490518589748426607852145425895222330958312263989336571873068530669910950281213189 39816088663889736000229882885329065762864349063182734565197212894128920780516039882105909916949016799206442320718930493066884851
```

Now that we have the factorization, we can calculate the private key and decrypt the flag.

```
>>> from gmpy import *
>>> N = 1172182071079403612819460591410436801254598455663212814122676976455521772943555586683995840410187689112480076452984704299817334381387842689748983063082229411869124571739688203711476164271691372368112347398301683214529319606705993490175490698699529245499839
>>> p = 29439910107053949247271976001319065960445588604490518589748426607852145425895222330958312263989336571873068530669910950281213189
>>> q = N/p
>>> p*q == N
True
>>> ct = 96709653113995447889069885726443915046145547045427406134082132152962349037010518017639393742816031781412745607010844837880349981090661985056562860660785120635366505165304951707783486361394735014070003093699368800709707494646119350233428007131415663152801
>>> e = 65537
>>> d = invert(e, (p-1)*(q-1))
>>> pt = pow(ct, d, N)
>>> hex(pt)[2:].decode('hex')
"SCTF{The_Return_of_Coppersmith's_Attack:Practical_Factorization_of_Widely_Used_RSA_Moduli}"
>>>
```
